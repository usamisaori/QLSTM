### 2.3.2 变分层

经量子编码后的量子态数据将输入变分层，变分层是 QNN 的可训练的主体部分，常以一系列参数化酉门等构成分层结构，如图 2.3.1（b）所示。其效用可以用如下的酉变换表示[83]：

$$\begin{align*}
  U(\overrightarrow{\theta}) &= U_L(\theta_L)...U_2(\theta_2)U_1(\theta_1)U_0(\theta_0) \\
  &=V_L(\theta_L)W_L...V_2(\theta_2)W_2V_1(\theta_1)W_1V_0(\theta_0)
\end{align*}$$

其中可迭代堆叠的每一层 $U_l(\theta_l) = V_l(\theta_l)W_l$ 包含由参数化酉门组成的旋转层 $V_l(\theta_l)$ 以及用于为线路提供纠缠能力的纠缠层 $W_l$。旋转层一般采用单比特旋转门或单比特旋转门组合而成的复合门等组成，用以不断调整量子态，其中的旋转参数作为 QNN 训练过程中的可学习参数，可以经由梯度下降等传统过程进行优化。纠缠层通常使用 CNOT 门或 CZ 门等两比特或多比特门组成，用以为量子线路提供纠缠能力。较之于经典神经网络，量子线路使用纠缠层来替代激活函数以实现多层结构[61]。同时纠缠能力也用于提升 QNN 对某些特定问题解空间的表示能力[79]。

基于不同旋转层与纠缠层的设计，变分层可以具有不同类型的结构。通常将变分层的结构称为拟设（Ansatz），拟设的设计与选择也得到了广泛地讨论[84]，通常着眼于设计与选择可表达能力强、纠缠能力强、可训练的拟设。受当前 NISQ 时代设备中噪声普遍存在与相干时间短等原因，量子门数增加也会导致更多的噪声并增加运行时间，进而导致性能下降。因此线路深度等复杂性指标也是设计与选择拟设时候需要考量的指标之一。